{"ast":null,"code":"// src/App.js\nimport React,{useEffect,useState}from'react';import axios from'axios';import io from'socket.io-client';// 與後端的 Socket.IO 連接\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const socket=io('https://inventory.edc-pws.com');function App(){const[products,setProducts]=useState([]);useEffect(()=>{// 取得產品數據\nconst fetchProducts=async()=>{try{const response=await axios.get('https://inventory.edc-pws.com/api/products');setProducts(response.data);}catch(error){console.error(\"Error fetching products:\",error);}};fetchProducts();// 監聽產品更新事件\nsocket.on('productUpdated',updatedProduct=>{setProducts(prevProducts=>prevProducts.map(product=>product.商品編號===updatedProduct.商品編號?updatedProduct:product));});// 清理階段\nreturn()=>{socket.off('productUpdated');};},[]);// 更新数量的函数\nconst updateQuantity=async(productCode,quantity)=>{try{await axios.put(`https://inventory.edc-pws.com/api/products/${productCode}`,{quantity});}catch(error){console.error(\"Error updating product:\",error);}};// 更新到期日\nconst updateExpiryDate=async(productCode,expiryDate)=>{try{await axios.put(`https://inventory.edc-pws.com/api/products/${productCode}`,{到期日:expiryDate});}catch(error){console.error(\"Error updating expiry date:\",error);}};// 处理输入变化\nconst handleQuantityChange=(productCode,quantity)=>{if(quantity<0){alert(\"Quantity cannot be negative.\");return;}const updatedProducts=products.map(product=>product.商品編號===productCode?{...product,數量:quantity}:product);setProducts(updatedProducts);// 更新本地状态\nupdateQuantity(productCode,quantity);// 调用后端接口更新数量\n};const handleExpiryDateChange=(productCode,expiryDate)=>{const updatedProducts=products.map(product=>product.商品編號===productCode?{...product,到期日:expiryDate}:product);setProducts(updatedProducts);// 更新本地状态\nupdateExpiryDate(productCode,expiryDate);// 更新到期日\n};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u5EAB\\u5B58\\u76E4\\u9EDE\\u7CFB\\u7D71\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u5546\\u54C1\\u7DE8\\u865F\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u5546\\u54C1\\u540D\\u7A31\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u898F\\u683C\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u6578\\u91CF\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u55AE\\u4F4D\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u5230\\u671F\\u65E5\"})]})}),products.map(product=>/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:product.商品編號}),/*#__PURE__*/_jsx(\"td\",{children:product.商品名稱}),/*#__PURE__*/_jsx(\"td\",{children:product.規格}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:product.數量,onChange:e=>handleQuantityChange(product.商品編號,+e.target.value)})}),/*#__PURE__*/_jsx(\"td\",{children:product.單位}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:product.到期日?new Date(product.到期日).toISOString().split('T')[0]:''// 格式化至YYYY-MM-DD\n,onChange:e=>handleExpiryDateChange(product.商品編號,e.target.value)})})]})}))]})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","axios","io","jsx","_jsx","jsxs","_jsxs","socket","App","products","setProducts","fetchProducts","response","get","data","error","console","on","updatedProduct","prevProducts","map","product","商品編號","off","updateQuantity","productCode","quantity","put","updateExpiryDate","expiryDate","到期日","handleQuantityChange","alert","updatedProducts","數量","handleExpiryDateChange","children","商品名稱","規格","type","value","onChange","e","target","單位","Date","toISOString","split"],"sources":["C:/Users/newli/OneDrive/123/inventory-system/inventory-client/src/App.js"],"sourcesContent":["// src/App.js\r\nimport React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport io from 'socket.io-client';\r\n\r\n// 與後端的 Socket.IO 連接\r\nconst socket = io('https://inventory.edc-pws.com');\r\n\r\nfunction App() {\r\n  const [products, setProducts] = useState([]);\r\n\r\n  useEffect(() => {\r\n    // 取得產品數據\r\n    const fetchProducts = async () => {\r\n      try {\r\n        const response = await axios.get('https://inventory.edc-pws.com/api/products');\r\n        setProducts(response.data);\r\n      } catch (error) {\r\n        console.error(\"Error fetching products:\", error);\r\n      }\r\n    };\r\n\r\n    fetchProducts();\r\n\r\n    // 監聽產品更新事件\r\n    socket.on('productUpdated', (updatedProduct) => {\r\n      setProducts(prevProducts =>\r\n        prevProducts.map(product =>\r\n           product.商品編號 === updatedProduct.商品編號 ? updatedProduct : product\r\n        )\r\n      );\r\n    });\r\n\r\n    // 清理階段\r\n    return () => {\r\n      socket.off('productUpdated');\r\n    };\r\n  }, []);\r\n\r\n  // 更新数量的函数\r\n  const updateQuantity = async (productCode, quantity) => {\r\n    try {\r\n      await axios.put(`https://inventory.edc-pws.com/api/products/${productCode}`, { quantity });\r\n    } catch (error) {\r\n      console.error(\"Error updating product:\", error);\r\n    }\r\n  };\r\n\r\n  // 更新到期日\r\n  const updateExpiryDate = async (productCode, expiryDate) => {\r\n    try {\r\n      await axios.put(`https://inventory.edc-pws.com/api/products/${productCode}`, { 到期日: expiryDate });\r\n    } catch (error) {\r\n      console.error(\"Error updating expiry date:\", error);\r\n    }\r\n  };\r\n\r\n  // 处理输入变化\r\n  const handleQuantityChange = (productCode, quantity) => {\r\n    if (quantity < 0) {\r\n      alert(\"Quantity cannot be negative.\");\r\n      return;\r\n    }\r\n    const updatedProducts = products.map(product =>\r\n      product.商品編號 === productCode ? { ...product, 數量: quantity } : product\r\n    );\r\n\r\n    setProducts(updatedProducts); // 更新本地状态\r\n    updateQuantity(productCode, quantity); // 调用后端接口更新数量\r\n  };\r\n\r\n  const handleExpiryDateChange = (productCode, expiryDate) => {\r\n    const updatedProducts = products.map(product =>\r\n      product.商品編號 === productCode ? { ...product, 到期日: expiryDate } : product\r\n    );\r\n\r\n    setProducts(updatedProducts); // 更新本地状态\r\n    updateExpiryDate(productCode, expiryDate); // 更新到期日\r\n  };\r\n  return (\r\n    <div>\r\n      <h1>庫存盤點系統</h1>\r\n      <ul>\r\n        <thead>\r\n            <tr>\r\n                <th>商品編號</th>\r\n\r\n                <th>商品名稱</th>\r\n\r\n                <th>規格</th>\r\n\r\n                <th>數量</th>\r\n\r\n                <th>單位</th>\r\n\r\n                <th>到期日</th>\r\n            </tr>\r\n\t\t\t</thead>\r\n\t\t\t{products.map(product => (\r\n\t\t\t<thead>\r\n            <tr>\r\n                <td>{product.商品編號}</td>\r\n                <td>{product.商品名稱}</td>\r\n                <td>{product.規格}</td>\r\n                <td><input type=\"number\" value={product.數量} onChange={(e) => handleQuantityChange(product.商品編號, +e.target.value)}/></td>\r\n                <td>{product.單位}</td>\r\n                <td><input type=\"date\" value={product.到期日 ? new Date(product.到期日).toISOString().split('T')[0] : ''} // 格式化至YYYY-MM-DD\r\n              onChange={(e) => handleExpiryDateChange(product.商品編號, e.target.value)}\r\n            /></td>\r\n\t\t\t </tr>\r\n\t\t\t</thead>\r\n          \r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}